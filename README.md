# AppendStuden
PyQt5-приложение для аналитики объектов. «Данные»: ввод/загрузка CSV/XLSX, таблица. «Регрессия»: t-отбор, удаление мультиколлинеарности, OLS, метрики; графики (t-барчарт, корр-матрица, pairplot) с сохранением PNG. α и порог |corr| хранятся в INI. Справа — предпросмотр изображений (в т.ч. HEIC), drag&amp;drop, экспорт в PNG.

## Общее описание

Это настольное приложение на PyQt5 для глубокой аналитики данных об объектах с постоянным предпросмотром изображений. Интерфейс разделён на левую область с тремя вкладками и правую панель изображения. Программа позволяет вручную вводить и редактировать наблюдения, загружать и сохранять таблицы, рассчитывать регрессионную модель по строгому пайплайну статистического отбора признаков, визуализировать результаты и экспортировать как текстовые отчёты, так и сами графики.
Вкладка «Данные»

Во вкладке «Данные» вводятся числовые показатели и выбираются кодированные категории, после чего строки добавляются в таблицу для последующего анализа. Ожидаются колонки с русскими именами: ширины и высоты в пикселях и процентах, аспектное отношение, дистанция, яркость, время суток, погода, качество фото и целевая переменная «Абс дист». При наличии ширины и высоты приложение автоматически вычисляет площадь ограничивающего прямоугольника и добавляет столбец «Площадь bbox (px²)». Числовые поля валидируются, запятая автоматически заменяется на точку, пропуски и нечисловые значения корректно обрабатываются. Таблицу можно сохранить в CSV с настраиваемым разделителем и точностью, а также загрузить из CSV или Excel; при открытии xlsx при необходимости предлагается выбрать лист, для чтения используется openpyxl. Выделенные строки можно удалять, редактирование ячеек доступно двойным кликом.
Вкладка «Регрессионная модель»

Во вкладке «Регрессионная модель» реализован пайплайн из четырёх последовательных этапов. Сначала для каждой числовой фичи вычисляется парная корреляция с целевой переменной и соответствующее t-значение по распределению Стьюдента с двумя сторонами; уровень значимости α настраивается пользователем и сохраняется между запусками. Далее выполняется итеративное удаление мультиколлинеарности: если максимальная попарная корреляция по модулю между оставшимися признаками превышает пользовательский порог, удаляется менее информативный признак, а при равной связи с целевой — тот, что сильнее «сцеплён» с другими; весь ход отбора подробно протоколируется в текстовом отчёте. Затем строится линейная регрессия методом наименьших квадратов в закрытой форме с устойчивым переходом на псевдообратную матрицу при вырожденности, формируется уравнение вида «Абс дист = b0 + Σ(bi × признак_i)». После этого считаются метрики, привычные пользователям Excel: множественный R, коэффициент детерминации R², скорректированный R² и среднеквадратичная ошибка RMSE; число наблюдений выводится отдельно. Для визуального анализа доступны три графика: горизонтальный барчарт |t|-значений с красной пороговой линией t_крит, тепловая корреляционная матрица для финального набора признаков вместе с целевой переменной и попарные диаграммы рассеяния (pairplot) по очищенному набору. Построенные графики показываются неблокирующим образом, чтобы не конфликтовать с циклом событий Qt, и любой последний показанный график можно сохранить в PNG с аккуратной обрезкой полей и повышенным DPI. Текстовый отчёт по итогам анализа в один клик сохраняется в .txt.
Панель изображения

Правая панель служит для постоянного предпросмотра иллюстраций, связанных с данными. Поддерживаются форматы PNG, JPEG, BMP и WebP, а также HEIC/HEIF при наличии модуля pillow-heif, который регистрируется автоматически; при отсутствии выводится понятное предупреждение. Изображения можно открыть через диалог или просто перетащить из проводника, предпросмотр вписывается в доступную область, а текущее изображение можно сохранить как PNG. Конвертация из PIL в QImage реализована напрямую через NumPy-массивы для стабильности и скорости.
Настройки и сохранность параметров

Параметры анализа, критичные для воспроизводимости, хранятся между запусками. Уровень значимости α и порог модуля корреляции для отсечения мультиколлинеарности записываются через QSettings в INI-файл без необходимости задавать идентичность приложения в ядре Qt. На Windows файл располагается в каталоге roaming-профиля пользователя внутри папки AnalyticsApp, на Linux и macOS используется стандартный конфигурационный каталог XDG или ~/.config. При старте приложения значения считываются и моментально отражаются в интерфейсе; любые изменения немедленно синхронизируются на диск.
Надёжность и поведение при ошибках

Программа аккуратно обращается с пропусками и бесконечностями, автоматически исключает строки без целевой переменной для расчётов, и формирует развёрнутые сообщения при проблемах чтения файлов или нехватке данных. Визуализация не запускает второй цикл событий и, таким образом, не провоцирует предупреждение о уже работающем event loop. Если модуль seaborn отсутствует, функциональность pairplot информативно отключается до его установки, остальные части анализа при этом полноценно работают.
